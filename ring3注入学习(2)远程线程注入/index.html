<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    blog
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="ticker tape timer">
<meta name="description" content="A CTFer loves RE and Misc">
<meta name="keywords" content="">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://tickertapetimer.github.io/styles/main.css" />
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.12/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.12/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://tickertapetimer.github.io">
                    blog
                </a>
            </div>

            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        首页
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        归档
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        标签
                    </a>
                    
                    <a class="menu-item" href="/me">
                        关于
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1629450714348" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://tickertapetimer.github.io">
                            blog
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1629450714348" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            首页
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            归档
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            标签
                        </a>
                        
                        <a class="menu-item" href="/me">
                            关于
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                ring3注入学习(2)远程线程注入
                            </h1>
                            
                                <!--en-->
                                <div class="post-meta en">
                                    Author:
                                    <a itemprop="author" rel="author" href="/">
                                        blog
                                    </a>
                                    <span class="post-time">
                                Date: <a href="#">2020-12-05</a>
                            </span>
                                    <span class="post-readtime">Reading Time:<a
                                    href="#">9.8
                                    mins</a></span>
                                    <span class="post-words">words:<a href="#">2458</a></span>
                                    
                                        <span class="post-category">
                                Category:
                                
                                <a href="https://tickertapetimer.github.io/tag/OI2yF9Mjr/">学习</a>
                                
                            </span>
                                        
                                </div>
                                
                        </header>
                        
                        <div class="post-content">
                            <h2 id="什么是dll注入">什么是DLL注入</h2>
<p>Dll注入原理：简单来说，就是通过程序A控制程序B，让程序B加载含有payload的dll，该dll在加载的过程中会执行dll中的恶意代码，从而实现注入。</p>
<p>DLL注入分为以下几个步骤：</p>
<p>（注入执行程序记为injector.py,要注入的程序记为aim.exe，注入的dll名为imhacker.dll）</p>
<ol>
<li>
<p>获取注入目标进程句柄</p>
</li>
<li>
<p>在目标进程中分配内存，分配的内存能够下存放dll完全路径字符串</p>
</li>
<li>
<p>将dll路径字符串写入刚刚分配的目标程序的内存之中</p>
</li>
<li>
<p>找到目标程序中LoadLibaray的入口地址</p>
</li>
<li>
<p>创建远程线程，实现最终注入</p>
</li>
</ol>
<h3 id="dllmain函数">DllMain函数</h3>
<p>跟exe有个main或者WinMain入口函数一样，DLL也有一个入口函数，就是DllMain</p>
<p>函数原型：</p>
<pre><code class="language-c++">BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    return TRUE;
}
</code></pre>
<ol>
<li><code>hModule</code>参数：<u>指向DLL本身的实例句柄</u></li>
<li><code>ul_reason_for_call</code>参数：<u>指明了DLL被调用的原因</u>，可以有以下4个取值：
<ol>
<li><code>DLL_PROCESS_ATTACH</code>：进程映射<br>
当DLL被进程 &lt;&lt;第一次&gt;&gt; 调用时，导致DllMain函数被调用，同时ul_reason_for_call的值为DLL_PROCESS_ATTACH，如果同一个进程后来再次调用此DLL时，操作系统只会增加DLL的使用次数，不会再用DLL_PROCESS_ATTACH调用DLL的DllMain函数。</li>
<li><code>DLL_PROCESS_DETACH</code>：进程卸载<br>
当DLL被从进程的地址空间解除映射时，系统调用了它的DllMain，传递的ul_reason_for_call值是DLL_PROCESS_DETACH。<br>
如果进程的终结是因为调用了TerminateProcess，系统就不会用DLL_PROCESS_DETACH来调用DLL的DllMain函数。这就意味着DLL在进程结束前没有机会执行任何清理工作。</li>
<li><code>DLL_THREAD_ATTACH</code>：线程映射<br>
当进程创建一线程时，系统查看当前映射到进程地址空间中的所有DLL文件映像，并用值DLL_THREAD_ATTACH调用DLL的DllMain函数。 新创建的线程负责执行这次的DLL的DllMain函数，只有当所有的DLL都处理完这一通知后，系统才允许线程开始执行它的线程函数。</li>
<li><code>DLL_THREAD_DETACH</code>：线程卸载<br>
如果线程调用了ExitThread来结束线程（线程函数返回时，系统也会自动调用ExitThread），系统查看当前映射到进程空间中的所有DLL文件映像，并用DLL_THREAD_DETACH来调用DllMain函数，通知所有的DLL去执行线程级的清理工作。</li>
</ol>
</li>
</ol>
<p>注意：如果线程的结束是因为系统中的一个线程调用了TerminateThread，系统就不会用值DLL_THREAD_DETACH来调用所有DLL的DllMain函数。</p>
<h2 id="制作dll">制作DLL</h2>
<h3 id="初步编写一个dll去作为payload">初步编写一个dll去作为payload</h3>
<pre><code class="language-c++">#include &quot;windows.h&quot;

BOOL WINAPI DllMain(HINSTANCE hMoudle,DWORD ul_reason_for_call,LPVOID lpReserved)
{
	switch(ul_reason_for_call)
	{
	case DLL_PROCESS_ATTACH:
		//恶意代码存放
	case DLL_THREAD_ATTACH:
	case DLL_THREAD_DETACH:
	case DLL_PROCESS_DETACH:
		break;
	}
	return true;
}
</code></pre>
<p>之所以要在DLL_PROCESS_ATTACH下存放恶意代码，是因为：</p>
<p>一个程序要调用Dll里的函数，首先要先把DLL文件映射到进程的地址空间。要把一个DLL文件映射到进程的地址空间，有两种方法：静态链接和动态链接的LoadLibrary或者LoadLibraryEx。<br>
当一个DLL文件被映射到进程的地址空间时，系统调用该DLL的DllMain函数，传递的ul_reason_for_call参数为DLL_PROCESS_ATTACH，这种调用只会发生在第一次映射时。如果同一个进程后来为已经映射进来的DLL再次调用LoadLibrary或者LoadLibraryEx，操作系统只会增加DLL的使用次数，它不会再用DLL_PROCESS_ATTACH调用DLL的DllMain函数。不同进程用LoadLibrary同一个DLL时，每个进程的第一次映射都会用DLL_PROCESS_ATTACH调用DLL的DllMain函数。</p>
<p>而注入是在DLL初次加载的时候执行操作，因此在DLL编写时，我们要将恶意代码放在DLL_PROCESS_ATTACH条件下去执行。</p>
<h3 id="编译">编译</h3>
<p>在release模式下将其编译组建为一个dll文件</p>
<h2 id="调用dll">调用DLL</h2>
<p>制作好DLL文件后，我们要寻找一个可以调用DLL的操作，这里使用了python去帮助实现注入</p>
<p>所需模块：</p>
<pre><code class="language-python">import sys
from ctypes import *
</code></pre>
<p>注：ctypes是Python的外部函数库。它提供C兼容的数据类型，并允许在DLL或共享库中调用函数</p>
<h3 id="获取句柄">获取句柄</h3>
<p>根据原理，想要实现注入，我们要先获得注入进程的句柄，获取进程句柄使用的api是OpenProcess.该函数一共有三个参数</p>
<pre><code class="language-c++">  HANDLE WINAPI OpenProcess(
  _In_  DWORD dwDesiredAccess,
  _In_  BOOL bInheritHandle,
  _In_  DWORD dwProcessId
  );
</code></pre>
<p>dwDesiredAccess参数是权限，我们需要获得所有操作的权限，即PROCESS_ALL_ACCESS，查阅后它的常量值为2035711，即1F0FFF</p>
<p>bInheritHandle是是否继承句柄，填false就好</p>
<p>dwProcessId是PID，是目标进程的进程标识符</p>
<p>所以OpenProcess函数以及参数编写如下：</p>
<pre><code class="language-python">PROCESS_ALL_ACCESS=0x001F0FFF
AimPid =sys.argv[1]
handle_aim=kernel32.OpenProcess(PROCESS_ALL_ACCESS,False,int(AimPid))
</code></pre>
<h3 id="申请内存">申请内存</h3>
<p>根据原理的第二步，我们需要在目标进程中申请一块内存去存放我们的DLL，这就需要两步，第一步是知道DLL的长度，第二步是申请一块这么大的内存，这时我们需要用到函数VirtualAllocEx。</p>
<p>VirtualAllocEx的作用是在指定进程的虚拟空间保留或提交内存区域，除非指定MEM_RESET参数，否则将该内存区域置0。</p>
<p>函数原形：</p>
<pre><code class="language-c++">LPVOID VirtualAllocEx(
HANDLE hProcess,
LPVOID lpAddress,
SIZE_T dwSize,
DWORD flAllocationType,
DWORD flProtect
);
</code></pre>
<p>hProcess：句柄</p>
<p>lpAddress：保留页面的内存地址；一般用NULL自动分配</p>
<p>dwSize：分配的大小</p>
<p>flAllocationType：分配方式，因为我们需要分配和提交修改到内存中，所以根据微软官方定义，将值设为MEM_COMMIT | MEM_RESERVE，宏定义即(0x1000|0x2000)</p>
<p>flProtect：内存保护方式，可设为可读可写，即PAGE_READWRITE（0x04）</p>
<p>所以构造如下：</p>
<pre><code class="language-python">MEMORY_ALLC=(0x1000|0x2000)
PAGE_READWRITE = 0x04
dll_path= sys.argv[2]
dll_path_len=len(dll_path)
dll_address=kernel32.VirtualAllocEx(handle_aim,0,dll_path_len,MEMORY_ALLC,PAGE_READWRITE)
</code></pre>
<h3 id="写入字符串">写入字符串</h3>
<p>申请到内存后，我们要将字符串写进去，这时要使用WriteProcessMemory函数</p>
<p>函数原型：</p>
<pre><code class="language-c++"> BOOL WINAPI WriteProcessMemory(
      _In_   HANDLE hProcess,
      _In_   LPVOID lpBaseAddress,
      _In_   LPCVOID lpBuffer,
      _In_   SIZE_T nSize,
      _Out_  SIZE_T *lpNumberOfBytesWritten
);
</code></pre>
<p>第一个参数代表句柄，为handle_aim.</p>
<p>第二个参数为写入的起始地址，为刚刚申请下来的dll_address.</p>
<p>第三个参数为写入内容，填dll_path.</p>
<p>第四个参数为写入大小，即dll_path_len.</p>
<p>第五个参数为输出参数，该指针可选，不需要可填NULL。使用byref(0)转化为null指针。</p>
<p>所以函数编写如下：</p>
<pre><code class="language-python">null_zero=c_int(0)
kernel32.WriteProcessMemory(handle_aim,dll_address,dll_path,dll_path_len,byref(null_zero))
</code></pre>
<h3 id="寻址">寻址</h3>
<p>要找到loadlibraryA的地址</p>
<p>loadlibrary函数主要作用为载入指定的动态链接库，并将它映射到当前进程使用的地址空间。一旦载入，即可访问库内保存的资源，成功则返回库模块的句柄。想要调用注入的dll，就必须要找到loadlibrary函数的地址</p>
<p>要找到loadlibrary函数，要从kernel32.dll着手，先用GetModuleHandle函数获取kernel32.dll的句柄，再通过GetProcAddress函数寻找loadlibrary函数的地址</p>
<pre><code class="language-c++">HMODULE WINAPI GetModuleHandle(
_In_opt_LPCTSTR lpModuleName
);
</code></pre>
<pre><code class="language-c++"> FARPROC GetProcAddress(
　　   HMODULE hModule, // DLL模块句柄
　　   LPCSTR lpProcName // 函数名 )        
</code></pre>
<p>函数编写如下：</p>
<pre><code class="language-python">handle_kernel32=kernel32.GetModuleHandleA(&quot;kernel32.dll&quot;)
Load_address=kernel32.GetProcAddress(handle_kernel32,&quot;LoadLibraryA&quot;)
</code></pre>
<h3 id="创建远程线程触发payload">创建远程线程，触发payload</h3>
<p>使用的函数是CreateRemoteThread，该函数参数有7个。</p>
<pre><code class="language-c++">   HANDLE WINAPI CreateRemoteThread(
	_In_  HANDLE hProcess,
	_In_  LPSECURITY_ATTRIBUTES lpThreadAttributes,
	_In_  SIZE_T dwStackSize,
	_In_  LPTHREAD_START_ROUTINE lpStartAddress,
	_In_  LPVOID lpParameter,
	_In_  DWORD dwCreationFlags,
	_Out_ LPDWORD lpThreadId
   );
</code></pre>
<p>第一个参数，远程句柄，还是handle_aim.</p>
<p>第二个参数，线程属性，没有特别说明，可填NULL,加载默认属性。Python中用None表示。</p>
<p>第三个参数，栈大小，我们用不到，填写0表示加载默认大小</p>
<p>第四个参数，线程起始时执行的函数地址，即上一步获得的Load_address.</p>
<p>第五个参数，线程起始执行函数的参数，我们要执行的是loadlibraryA(“injected_dll_path”)</p>
<p>所以，这个参数为dll_address</p>
<p>第六个参数，表示线程创建后的操作。我们要让该线程一旦创建便立即执行，需要填0.</p>
<p>最后一个参数，表示接收创建的线程ID。是个double word类型，在ctypes中用c_ulong即可</p>
<p>函数编写如下：</p>
<pre><code class="language-python">thread_id=c_ulong(0)
kernel32.CreateRemoteThread(handle_aim,None,0,Load_address,dll_address,0,byref(thread_id))
</code></pre>
<h2 id="使用">使用</h2>
<p>运行python，参数输入想要注入的线程PID和DLL的地址，然后回车</p>
<h2 id="不用python的正常注入手段">不用python的正常注入手段</h2>
<pre><code class="language-c++">#include &lt;Windows.h&gt;

void Inject(int pID, char* Path)
{
    //获取进程句柄
    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pID);

    //申请一块内存给DLL路径
    LPVOID pReturnAddress = VirtualAllocEx(hProcess, NULL, strlen(Path) + 1, MEM_COMMIT, PAGE_READWRITE);

    //写入路径到上一行代码申请的内存中
    WriteProcessMemory(hProcess, pReturnAddress, Path, strlen(Path) + 1, NULL);


    //获取LoadLibraryA函数的地址
    HMODULE hModule = LoadLibrary(L&quot;KERNEL32.DLL&quot;);
    LPTHREAD_START_ROUTINE lpStartAddress = (LPTHREAD_START_ROUTINE)GetProcAddress(hModule, &quot;LoadLibraryA&quot;);


    //创建远程线程-并获取线程的句柄
    HANDLE hThread = CreateRemoteThread(hProcess, NULL, 0, lpStartAddress, pReturnAddress, 0, NULL);

    //等待线程事件
    WaitForSingleObject(hThread, 2000);


    //防止内存泄露
    CloseHandle(hThread);
    CloseHandle(hProcess);

}

int main()
{
    //传dll路径
    const char* a = &quot;路径&quot;;

    //传入进程ID
    Inject(PID, (char*)a);

    return 0;
}
</code></pre>
<h2 id="获取pid">获取PID</h2>
<p>由于进程打开时的PID是随机分配的，所以要实时获取PID，可以通过进程名去获取PID</p>
<pre><code class="language-c++">//根据PID去获取句柄
HMODULE GetProcessModuleHandleByName(DWORD pid, LPCSTR ModuleName)
{
    MODULEENTRY32 ModuleInfo;
    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, pid);//拍摄进程快照，录入信息
    if (!hSnapshot)
    {
        return 0;
    }
    ZeroMemory(&amp;ModuleInfo, sizeof(MODULEENTRY32));//将MODULEENTRY32结构的ModuleInfo数据填充为0
    ModuleInfo.dwSize = sizeof(MODULEENTRY32);
    if (!Module32First(hSnapshot, &amp;ModuleInfo))
    {
        return 0;
    }
    do//查找比较进程名，返回句柄
    {
        if (!lstrcmpi(ModuleInfo.szModule, ModuleName))
        {
            CloseHandle(hSnapshot);
            return ModuleInfo.hModule;
        }
    } while (Module32Next(hSnapshot, &amp;ModuleInfo));
    CloseHandle(hSnapshot);
    return 0;
}
//获取进程PID
DWORD GetProcessIDByName(const char* pName)
{
    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);//拍摄一个快照，返回打开的句柄到指定的快照
    if (INVALID_HANDLE_VALUE == hSnapshot) {//检测是否成功打开
        return NULL;
    }
    PROCESSENTRY32 pe = { sizeof(pe) };//创建一个PROCESSENTRY32类型的结构体并获取他的长度
    //循环检测进程中每一个模块的进程名，返回进程的PID
    for (BOOL ret = Process32First(hSnapshot, &amp;pe); ret; ret = Process32Next(hSnapshot, &amp;pe)) {
        if (strcmp(pe.szExeFile, pName) == 0) {
            CloseHandle(hSnapshot);
            return pe.th32ProcessID;
        }
    }
    CloseHandle(hSnapshot);
    return 0;
}
</code></pre>
<h2 id="ps">PS：</h2>
<p>DLL要设置权限，不然远程创建线程会失败</p>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AFdll%E6%B3%A8%E5%85%A5">什么是DLL注入</a>
<ul>
<li><a href="#dllmain%E5%87%BD%E6%95%B0">DllMain函数</a></li>
</ul>
</li>
<li><a href="#%E5%88%B6%E4%BD%9Cdll">制作DLL</a>
<ul>
<li><a href="#%E5%88%9D%E6%AD%A5%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAdll%E5%8E%BB%E4%BD%9C%E4%B8%BApayload">初步编写一个dll去作为payload</a></li>
<li><a href="#%E7%BC%96%E8%AF%91">编译</a></li>
</ul>
</li>
<li><a href="#%E8%B0%83%E7%94%A8dll">调用DLL</a>
<ul>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%8F%A5%E6%9F%84">获取句柄</a></li>
<li><a href="#%E7%94%B3%E8%AF%B7%E5%86%85%E5%AD%98">申请内存</a></li>
<li><a href="#%E5%86%99%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2">写入字符串</a></li>
<li><a href="#%E5%AF%BB%E5%9D%80">寻址</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E8%BF%9C%E7%A8%8B%E7%BA%BF%E7%A8%8B%E8%A7%A6%E5%8F%91payload">创建远程线程，触发payload</a></li>
</ul>
</li>
<li><a href="#%E4%BD%BF%E7%94%A8">使用</a></li>
<li><a href="#%E4%B8%8D%E7%94%A8python%E7%9A%84%E6%AD%A3%E5%B8%B8%E6%B3%A8%E5%85%A5%E6%89%8B%E6%AE%B5">不用python的正常注入手段</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96pid">获取PID</a></li>
<li><a href="#ps">PS：</a></li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                    
                                        <!--en-->
                                        <section class="post-copyright en">
                                            <p class="copyright-item">
                                                <span>Author:</span>
                                                <span>blog</span>
                                            </p>

                                            <p class="copyright-item">
                                                <span>Permalink:</span>
                                                <span><a href="https://tickertapetimer.github.io/ring3注入学习(2)远程线程注入/">https://tickertapetimer.github.io/ring3注入学习(2)远程线程注入/</a></span>
                                            </p>

                                            <p class="copyright-item">
                                                <span>License:</span>
                                                <span>MIT License</span>
                                            </p>
                                        </section>
                                        
                                                
                                                    
                                                        <!-- Share-->
                                                        <span style="margin-right:15px">
                                                    <i class="post-share"></i>
                                                    <span>Share:</span>
                                                        <a title="QR Code" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://tickertapetimer.github.io/ring3注入学习(2)远程线程注入/"><i class="fa fa-qrcode"></i></a>
                                                        <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://tickertapetimer.github.io/ring3注入学习(2)远程线程注入/&sharesource=qzone&title=ring3注入学习(2)远程线程注入&pics=https://tickertapetimer.github.io/images/avatar.png?v=1629450714348&summary="><i class="fa fa-qq"></i></a>
                                                        <a title="Weibo" target="_blank" href="https://service.weibo.com/share/share.php?url=https://tickertapetimer.github.io/ring3注入学习(2)远程线程注入/&sharesource=weibo&title=ring3注入学习(2)远程线程注入 + " - " + &pic="https://tickertapetimer.github.io/images/avatar.png?v=1629450714348 "><i class="fa fa-weibo "></i></a>
                                                        
                                                                </span>
                                                                <!--en-->
                                                                <section class="post-tags en ">
                                                                    <div>
                                                                        <span>Tag(s):</span>
                                                                        <span class="tag ">
                        
                        
                        <a href="https://tickertapetimer.github.io/tag/OI2yF9Mjr/">#
                                                学习
                                                    </a>
                                                    
                                                        
                                                            </span>
                                                                    </div>
                                                                    <div>
                                                                        <a href="javascript:window.history.back();">back</a>
                                                                        <span>&dot;</span>
                                                                        <a href="#">home</a>
                                                                    </div>
                                                                </section>
                                                                
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://tickertapetimer.github.io/通过阉割FreeLibrary来实现DLL隐藏/">
                                                                                            通过阉割FreeLibrary来实现DLL隐藏
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://tickertapetimer.github.io/逆向讲课/">
                                                                                                    逆向讲课
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        blog &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://coding.net" target="_blank">
                                                Coding.net
                                            </a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.7.5
                </div>
                
                    <script>
                        var pat = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + pat + '</div>')
                    </script>
        </footer>
        
                <script>
                    
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    CheckVersion();
                    
                    var newDate = new Date();
                    newDate.setTime(1629450714348);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
                
        </div>
</body>
<script>
    scroll();
</script>

</html>